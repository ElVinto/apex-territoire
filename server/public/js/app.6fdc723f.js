(function(e){function t(t){for(var a,o,i=t[0],c=t[1],l=t[2],u=0,p=[];u<i.length;u++)o=i[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&p.push(s[o][0]),s[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);d&&d(t);while(p.length)p.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],a=!0,i=1;i<r.length;i++){var c=r[i];0!==s[c]&&(a=!1)}a&&(n.splice(t--,1),e=o(o.s=r[0]))}return e}var a={},s={app:0},n=[];function o(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=a,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(r,a,function(t){return e[t]}.bind(null,a));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var d=c;n.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";var a=r("85ec"),s=r.n(a);s.a},"05a9":function(e,t,r){},"05ee":function(e,t,r){"use strict";var a=r("db8a"),s=r.n(a);s.a},"20c6":function(e,t,r){"use strict";var a=r("6cb1"),s=r.n(a);s.a},"25b2":function(e,t,r){"use strict";var a=r("8600"),s=r.n(a);s.a},3588:function(e,t,r){},"39b3":function(e,t,r){},4678:function(e,t,r){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(e){var t=n(e);return r(t)}function n(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}s.keys=function(){return Object.keys(a)},s.resolve=n,e.exports=s,s.id="4678"},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d"),r("6cc5");var a=r("2b0e"),s=(r("99af"),r("c740"),r("d81d"),r("4ec9"),r("d3b7"),r("3ca3"),r("ddb0"),r("b85c")),n=(r("96cf"),r("1da1")),o=r("2f62"),i=(r("7db0"),r("4160"),r("25f0"),r("159b"),r("d4ec")),c=r("bee2"),l=r("bc3a"),d=r.n(l);r("ed18").config();var u="db-services";var p=function(){function e(){Object(i["a"])(this,e)}return Object(c["a"])(e,null,[{key:"pwsadd",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){try{null!==t&&null!=t.transaction&&"alter_password"===t.transaction?d.a.post(u+"/password",t).then((function(t){e(t.affectedRows)})):r(" ERROR  does not accet "+t)}catch(a){r(a)}})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"checkEMail",value:function(e){console.log("Checking email of "+e);var t={transaction:"select_useremail",userEMail:e};return new Promise((function(e,r){try{d.a.post(u+"/login",t).then((function(t){void 0!==t.data&&t.data.length>0?e(!0):e(!1)}))}catch(a){r(a)}}))}},{key:"checkEMailAuth",value:function(e){var t={transaction:"select_useremailAuth",userEMail:e};return new Promise((function(e,r){try{d.a.post(u+"/checkAuth",t).then((function(t){null!==t&&t.data.length>0?(console.log("mail  enregistrer dans la table auth"),e(!0)):(console.log("mail n'est pas enregistrer dans auth"),e(!1))}))}catch(a){r(a)}}))}},{key:"checkpasswordRequire",value:function(e){var t={transaction:"select_passwordRequireAuth",userEMail:e};return new Promise((function(e,r){try{d.a.post(u+"/checkAuth",t).then((function(t){void 0!==t&&(1===t.data[0].passwordRequire?(console.log("passwordRequire existe"),e(!0)):(console.log("passwordRequire non existe"),e(!1)))}))}catch(a){r(a)}}))}},{key:"checkPassword",value:function(e,t){var r={transaction:"check_passwordLogin",password:e,UserEMail:t};return new Promise((function(e,t){try{d.a.post(u+"/password",r).then((function(t){console.log("checkPassword result form call to db: "),console.log(t),t&&!0===t.data?e(!0):e(!1)}))}catch(a){t(a)}}))}},{key:"mailAddToAuth",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={transaction:"insert_userEmail",userEMail:t,password:null,passwordRequire:0},e.abrupt("return",d.a.post(u+"/checkAuth",r).then((function(e){console.log("mailAddToAuth result from DB"),console.log(e),e&&e.data.affectedRows>0?console.log("mail a été ajouté"):console.log("non ajouté")})));case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getObservations",value:function(e){return console.log("getObservations of "+e),new Promise((function(t,r){try{var a={transaction:"select_observations",userEMail:e};d.a.post(u,a).then((function(e){t(e.data)}))}catch(s){r(s)}}))}},{key:"getSharedObservations",value:function(e,t){return console.log("getSharedObservations of  "+e+" from "+t),new Promise((function(r,a){try{var s={transaction:"select_sharedobservations",dataOwnerEMail:e,parcelName:t};d.a.post(u,s).then((function(e){r(e.data)}))}catch(n){a(n)}}))}},{key:"getModifiedWeekMetrics",value:function(e){return console.log("getmodifiedWeekMetrics from "+e),new Promise((function(t,r){try{var a={transaction:"select_modifiedweekmetrics",useremail:e};d.a.post(u,a).then((function(e){t(e.data)}))}catch(s){r(s)}}))}},{key:"sendToModifiedWeekMetrics",value:function(e){return console.log(e),new Promise((function(t,r){try{null!==e&&null!=e.transaction&&("select_modifiedweekmetrics"===e.transaction||"alter_modifiedweekmetrics"===e.transaction||"delete_modifiedweekmetrics"===e.transaction)?("select_modifiedweekmetrics"===e.transaction&&d.a.post(u,e).then((function(e){t(e.data,console.log("ok"))})),"alter_modifiedweekmetrics"===e.transaction&&(console.log(e),d.a.post(u,e).then((function(e){t(e.affectedRows)}))),"delete_modifiedweekmetrics"===e.transaction&&d.a.post(u,e).then((function(e){t(e.affectedRows)}))):r(" ERROR sendToModifiedWeekMetrics does not accet "+e)}catch(a){r(a)}}))}},{key:"sendToParcelDataSharing",value:function(e){return new Promise((function(t,r){try{null!==e&&null!=e.transaction&&("select_parceldatasharing"===e.transaction||"insert_parceldatasharing"===e.transaction||"delete_parceldatasharing"===e.transaction)?("select_parceldatasharing"===e.transaction&&d.a.post(u,e).then((function(e){t(e.data)})),"insert_parceldatasharing"===e.transaction&&(console.log(e),d.a.post(u,e).then((function(e){t(e.affectedRows)}))),"delete_parceldatasharing"===e.transaction&&(console.log(e),console.log(e.dataOwnerEMail),console.log(e.dataUserEMail),console.log(e.parcelName),d.a.post(u,e).then((function(r){console.log(e),t(r.affectedRows,console.log("ok"))})))):r(" ERROR sendToModifiedWeekMetrics does not accet "+e)}catch(a){r(a)}}))}},{key:"postQuery",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.url,t=arguments.length>1?arguments[1]:void 0;return new Promise((function(r,a){try{d.a.post(e,t).then((function(e){r(e)}))}catch(s){a(s)}}))}},{key:"deleteQuery",value:function(e){return d.a.delete(u,e)}},{key:"getMonthLabel",value:function(e){switch(e){case 0:return"Jan";case 1:return"Feb";case 2:return"Mar";case 3:return"Apr";case 4:return"May";case 5:return"Jun";case 6:return"Jul";case 7:return"Aug";case 8:return"Sep";case 9:return"Oct";case 10:return"Nov";case 11:return"Dec";default:return}}},{key:"getDayLabel",value:function(e){switch(e){case"1":return"Mon";case"2":return"Tue";case"3":return"Wed";case"4":return"Thu";case"5":return"Fri";case"6":return"Sat";case"0":return"Sun";default:return}}},{key:"extractUserDataObjFrom",value:function(t){console.log("extractUserDataObjFrom : nbRows: "+t.length);var r={};return t.forEach((function(t){void 0===r.userEMail&&(r=new e.MonitoredUser(t.userEMail,t.userId,t.userName));var a=r.parcels.find((function(e){return e.parcelName===t.parcelName}));void 0===a&&(a=new e.MonitoredParcel(t.parcelName,t.userEMail,t.userName,t.userId,{lat:t.parcelLat,lng:t.parcelLng}),r.parcels.push(a));var s=new Date;s.setTime(t.sessionDateInSec+"000");var n=s.getFullYear(),o=a.parcelYears.find((function(e){return e.yearNumber===n}));void 0===o&&(o=new e.MonitoredYear(n),a.parcelYears.push(o));var i=new Date(n,0,1),c=864e5,l=c*(1===i.getDay()?0:0===i.getDay()?1:8-i.getDay()),d=new Date;d.setTime(i.getTime()+l);var u=s.getTime()===d.getTime()?1:Math.ceil((s.getTime()-d.getTime())/c/7),p=s.getTime()-c*(1===s.getDay()?0:0===s.getDay()?6:s.getDay()-1),m=new Date;m.setTime(p);var h=o.yearWeeks.find((function(e){return e.weekNumber===u}));void 0===h&&(h=new e.MonitoredWeek(t.sessionDateInSec+"000"),o.yearWeeks.push(h));var b=h.weekSessions.find((function(e){return e.sessionDateInMs===t.sessionDateInSec+"000"}));void 0===b&&(b=new e.MonitoredSession(t.sessionDateInSec+"000"),h.weekSessions.push(b));var v=new e.MonitoredObservation(t.obsvLabel,t.obsvDateInMs,t.userName,t.userName,{lat:t.obsvLat,lng:t.obsvLng});b.sessionObservations.push(v)})),r}},{key:"addSharedParcelObservations",value:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){var a,n,o,i,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("getSharedParcelObservations"),t.next=3,e.sendToParcelDataSharing({transaction:"select_parceldatasharing",userEMail:r.userEMail});case 3:a=t.sent,n=Object(s["a"])(a),t.prev=5,n.s();case 7:if((o=n.n()).done){t.next=15;break}return i=o.value,t.next=11,e.getSharedObservations(i.dataOwnerEMail,i.parcelName);case 11:c=t.sent,c.length>0&&(l=e.extractUserDataObjFrom(c),r.parcels.push(l.parcels[0]));case 13:t.next=7;break;case 15:t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](5),n.e(t.t0);case 20:return t.prev=20,n.f(),t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[5,17,20,23]])})));function r(e){return t.apply(this,arguments)}return r}()},{key:"addWeeksToUserDataObj",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2019,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2020,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:32;if(console.log("addWeeksToUserDataObj "),void 0===t.parcels)throw" No parcels is currently monitored by the user";for(var o=[],i=[],c=0;c<t.parcels.length;c++){var l=t.parcels[c];if(void 0!==l.parcelYears)for(var d=function(e){var t=l.parcelYears[e].yearNumber;void 0===o.find((function(e){return e===t}))&&o.push(t)},u=0;u<l.parcelYears.length;u++)d(u);for(var p=function(e){void 0===o.find((function(t){return t===e}))&&o.push(e)},m=r;m<=a;m++)p(m);if(void 0!==l.parcelYears)for(var h=0;h<l.parcelYears.length;h++)if(void 0!==l.parcelYears[h].yearWeeks)for(var b=function(e){var t=l.parcelYears[h].yearWeeks[e].weekNumber;void 0===i.find((function(e){return e===t}))&&i.push(t)},v=0;v<l.parcelYears[h].yearWeeks.length;v++)b(v);for(var f=function(e){void 0===i.find((function(t){return t===e}))&&i.push(e)},g=s;g<=n;g++)f(g)}for(var w=0;w<t.parcels.length;w++)for(var k=t.parcels[w],x=function(t){var r=o[t],a=k.parcelYears.find((function(e){return e.yearNumber===r}));void 0===a&&(a=new e.MonitoredYear(r),k.parcelYears.push(a));for(var s=function(t){var s=i[t],n=a.yearWeeks.find((function(e){return e.weekNumber===s}));void 0===n&&(n=new e.MonitoredWeek(r,s),a.yearWeeks.push(n))},n=0;n<i.length;n++)s(n)},y=0;y<o.length;y++)x(y)}},{key:"enforceConsistencyOfUserDataObj",value:function(e){if(console.log("enforceConsistencyOfUserDataObj "),void 0===e.parcels)throw" No parcels is currently monitored by the user";for(var t=0;t<e.parcels.length;t++){var r=e.parcels[t];if(void 0!==r.parcelYears&&r.parcelYears.length>0)for(var a=0;a<r.parcelYears.length;a++){var s=r.parcelYears[a];if(void 0!==s.yearWeeks&&s.yearWeeks.length>0)for(var n=0;n<s.yearWeeks.length;n++){var o=s.yearWeeks[n];if(void 0!==o.weekSessions&&o.weekSessions.length>0){var i=0,c=0,l=0,d=0,u=0;this.weekICApex=0;for(var p=0;p<o.weekSessions.length;p++){var m=o.weekSessions[p],h=0,b=0;if(void 0!==m.sessionObservations){for(var v=0;v<m.sessionObservations.length;v++){var f=m.sessionObservations[v];"P"===f.obsvLabel&&l++,"R"===f.obsvLabel&&d++,"C"===f.obsvLabel&&u++,h+=f.obsvValue,b++,c+=f.obsvValue,i++}b>0&&(m.sessionAVGrowth=h/b)}}o.weekNbObservations=i,o.weekNbObsFullGrowth=l,o.weekNbObsSlowGrowth=d,o.weekNbObsStoppedGrowth=u,o.weekAVGrowth=Math.round(100*c/i)/100,o.weekPrctFullGrowth=Math.round(1e4*l/i)/100,o.weekPrctSlowGrowth=Math.round(1e4*d/i)/100,o.weekPrctStoppedGrowth=Math.round(1e4*u/i)/100,o.weekICApex=o.reInitICApex()}}}}}},{key:"sortUserDataObjByYearByWeek",value:function(e){if(void 0===e.parcels)throw" No parcels is currently monitored by the user";for(var t=0;t<e.parcels.length;t++){var r=e.parcels[t];if(void 0!==r.parcelYears&&r.parcelYears.length>0){for(var a=0;a<r.parcelYears.length;a++){var s=r.parcelYears[a];void 0!==s.yearWeeks&&s.yearWeeks.length>0&&s.yearWeeks.sort((function(e,t){return e.weekNumber-t.weekNumber}))}r.parcelYears.sort((function(e,t){return e.yearNumber-t.yearNumber}))}}}},{key:"MonitoredUser",value:function(e,t,r){var a=this;this.userEMail=e,this.userId=t,this.userName=r,this.parcels=[],this.toString=function(){return"user: email ".concat(a.userEMail," id: ").concat(a.userId," name ").concat(a.userName)}}},{key:"MonitoredParcel",value:function(e,t,r,a,s){var n=this;this.parcelName=e,this.dataOwnerEMail=t,this.dataOwnerName=r,this.dataOwnerId=a,this.parcelCoord=s,this.parcelYears=[],this.toString=function(){return"parcel: "+n.parcelName}}},{key:"MonitoredYear",value:function(e){this.yearNumber=e,this.yearWeeks=[],this.toString=function(){return"year: ".concat(this.yearNumber)}}},{key:"MonitoredWeek",value:function(t,r){var a=this;if(this.weekNumber=0,this.weekLabel="",this.weekFullDate=new Date,this.weekSessions=[],this.weekNbObservations=0,this.weekNbObsFullGrowth=0,this.weekNbObsSlowGrowth=0,this.weekNbObsStoppedGrowth=0,this.weekPrctFullGrowth=0,this.weekPrctSlowGrowth=0,this.weekPrctStoppedGrowth=0,this.weekAVGrowth=0,this.weekICApex=0,this.toString=function(){return"w"+a.weekNumber+"("+a.weekLabel+")"},void 0===r){var s=t,n=new Date;n.setTime(s);var o=new Date(n.getFullYear(),0,1),i=864e5,c=i*(1===o.getDay()?0:0===o.getDay()?1:8-o.getDay()),l=new Date;l.setTime(o.getTime()+c);var d=n.getTime()===l.getTime()?1:Math.ceil((n.getTime()-l.getTime())/i/7),u=n.getTime()-i*(1===n.getDay()?0:0===n.getDay()?6:n.getDay()-1),p=new Date;p.setTime(u);var m=p.getDate()+" "+e.getMonthLabel(p.getMonth());this.weekNumber=d,this.weekLabel=m,this.weekFullDate=p.toString()}else{var h=t,b=r,v=new Date(h,0,1),f=864e5,g=f*(1===v.getDay()?0:0===v.getDay()?1:8-v.getDay()),w=new Date;w.setTime(v.getTime()+g);var k=w.getTime()+7*f*(b-1),x=new Date;x.setTime(k);var y=x.getDate()+" "+e.getMonthLabel(x.getMonth());this.weekNumber=b,this.weekLabel=y,this.weekFullDate=x.toString()}this.reInitICApex=function(){var e=3;return this.weekAVGrowth>=.75?e=0:this.weekPrctFullGrowth>=5?e=1:this.weekPrctSlowGrowth<=90&&(e=2),e}}},{key:"MonitoredSession",value:function(t){var r=new Date;r.setTime(t),this.sessionDateInMs=t,this.sessionDateLabel=r.getDate()+" "+e.getMonthLabel(r.getMonth())+" "+r.getFullYear(),this.sessionAVGrowth=0,this.sessionICApex=0,this.sessionObservations=[]}},{key:"MonitoredObservation",value:function(e,t,r,a,s){this.initObsvValueFromLabel=function(e){switch(e){case"P":return 1;case"R":return.5;case"C":return 0;default:return}},this.obsvLabel=e,this.obsvValue=this.initObsvValueFromLabel(e),this.obsvDateInMs=t,this.obsvOwnerName=r,this.obsvUserName=a,this.obsvCoord=s}}]),e}(),m=p,h=r("0e44");a["default"].use(o["a"]);var b=function(){return{activedNavbar:"",navbarModel:"",mailpresent:"",PasswordRequire:"",loggedUserEmail:"",demoUserEMail:"",userDataObj:null,selectedParcelIdx:0,selectedYearIdx:0,selectedWeekIdx:0,userModifiedWeekMetrics:new Map,forceComponentUpdateCounter:0,viewMode:"developpement",strict:!0,plugins:[Object(h["a"])()]}},v=new o["a"].Store({state:{navbarModel:"",activedNavbar:"",mailpresent:"",PasswordRequire:"",loggedUserEmail:"",demoUserEmail:"",userDataObj:null,selectedParcelIdx:0,selectedYearIdx:0,selectedWeekIdx:0,userModifiedWeekMetrics:new Map,forceComponentUpdateCounter:0,viewMode:"developpement",strict:!0,plugins:[Object(h["a"])()]},getters:{getDisplayedUserEMail:function(e){return e.demoUserEmail?"visiteur.demo@apex-territoire.fr":e.loggedUserEmail},getDisplayedUserName:function(e){return e.demoUserEmail?"Visiteur Démo":e.userDataObj?e.userDataObj.userName:"No userName"},getDisplayedUserNameIfNeeded:function(e){return function(t,r){return e.demoUserEmail&&t===e.demoUserEmail?"Utilisateur Démo":r}},parcelNameList:function(e){return null===e.userDataObj?[]:null!==e.userDataObj.parcels?e.userDataObj.parcels.map((function(e){return e.parcelName})):void 0},yearNumberList:function(e){return null!==e.userDataObj&&null!==e.userDataObj.parcels[e.selectedParcelIdx]?e.userDataObj.parcels[e.selectedParcelIdx].parcelYears.map((function(e){return e.yearNumber})):[]},weekLabelList:function(e){return null!==e.userDataObj&&null!==e.userDataObj.parcels[e.selectedParcelIdx]&&null!==e.userDataObj.parcels[e.selectedParcelIdx].parcelYears[e.selectedYearIdx]&&null!==e.userDataObj.parcels[e.selectedParcelIdx].parcelYears[e.selectedYearIdx].yearWeeks?e.userDataObj.parcels[e.selectedParcelIdx].parcelYears[e.selectedYearIdx].yearWeeks.map((function(e){return e.weekLabel})):[]},getParcelIdx:function(e){return function(t,r){return null!==e.userDataObj?e.userDataObj.parcels.findIndex((function(e){return e.parcelName===t&&e.dataOwnerEMail===r})):null}},getYearIdx:function(e){return function(t){return null!==e.userDataObj?e.userDataObj.parcels[0].parcelYears.findIndex((function(e){return e.yearNumber===t})):-1}},getWeekIdx:function(e){return function(t){return null!==e.userDataObj?e.userDataObj.parcels[0].parcelYears[0].yearWeeks.findIndex((function(e){return e.weekNumber===t})):-1}},getSelectedWeekMetric:function(e,t){return t.getWeekMetric(e.selectedParcelIdx,e.selectedYearIdx,e.selectedWeekIdx)},getWeekMetric:function(e){return function(t,r,a){var s="pIdx:".concat(t," yIdx:").concat(r," wIdx:").concat(a);if(e.userModifiedWeekMetrics.has(s))return e.userModifiedWeekMetrics.get(s);e.userDataObj.parcels[e.selectedParcelIdx].parcelYears[e.selectedYearIdx];var n=new Date(e.userDataObj.parcels[t].parcelYears[r].yearWeeks[a].weekFullDate),o={dataUserEMail:e.userDataObj.userEMail,dataOwnerEMail:e.userDataObj.parcels[t].dataOwnerEMail,parcelName:e.userDataObj.parcels[t].parcelName,yearNumber:e.userDataObj.parcels[t].parcelYears[r].yearNumber,weekNumber:e.userDataObj.parcels[t].parcelYears[r].yearWeeks[a].weekNumber,nbObsFullGrowth:e.userDataObj.parcels[t].parcelYears[r].yearWeeks[a].weekNbObsFullGrowth,nbObsSlowGrowth:e.userDataObj.parcels[t].parcelYears[r].yearWeeks[a].weekNbObsSlowGrowth,nbObsStoppedGrowth:e.userDataObj.parcels[t].parcelYears[r].yearWeeks[a].weekNbObsStoppedGrowth,dateTimeInMs:n.getTime(),modified:!1};return o}},getSelectedWeekMetricTotalNbObs:function(e,t){return t.getTotalNbObs(e.selectedParcelIdx,e.selectedYearIdx,e.selectedWeekIdx)},getTotalNbObs:function(e,t){return function(e,r,a){var s=t.getWeekMetric(e,r,a),n=parseInt(s.nbObsFullGrowth),o=parseInt(s.nbObsSlowGrowth),i=parseInt(s.nbObsStoppedGrowth);return n+o+i}},getSelectedWeekMetricAvgGrowth:function(e,t){return t.getAvgGrowth(e.selectedParcelIdx,e.selectedYearIdx,e.selectedWeekIdx)},getAvgGrowth:function(e,t){return function(e,r,a){var s=t.getWeekMetric(e,r,a),n=parseInt(s.nbObsFullGrowth),o=parseInt(s.nbObsSlowGrowth),i=parseInt(s.nbObsStoppedGrowth),c=n+o+i;return 0==c?0:(n+.5*o)/c}},getSelectedWeekMetricHydricConstraint:function(e,t){return t.getHydricConstraint(e.selectedParcelIdx,e.selectedYearIdx,e.selectedWeekIdx)},getHydricConstraint:function(e,t){return function(e,r,a){var s=t.getWeekMetric(e,r,a),n=parseInt(s.nbObsFullGrowth),o=parseInt(s.nbObsSlowGrowth),i=parseInt(s.nbObsStoppedGrowth),c=n+o+i,l=0,d=0,u=0;c>0&&(l=Math.round(n/c*100),d=Math.round(o/c*100),u=(.5*d+l)/100);var p=3;return u>=.75?p=0:d>=5?p=1:d<=90&&(p=2),0==c?0:p}}},mutations:{RESET:function(e){Object.assign(e,b())},initNavbarModel:function(e,t){e.navbarModel=t},initActivedNavbar:function(e,t){e.activedNavbar=t},initPasswordRequire:function(e,t){e.PasswordRequire=t},initmailpresent:function(e,t){e.mailpresent=t},initLoggedUserEmail:function(e,t){e.loggedUserEmail=t},initDemoUserEmail:function(e,t){e.demoUserEmail=t},initUserDataObj:function(e,t){e.userDataObj=t},updateSelectedParcelIdx:function(e,t){e.selectedParcelIdx=t,console.log(" store updated state.selectedParcelIdx "+e.selectedParcelIdx)},updateSelectedYearIdx:function(e,t){e.selectedYearIdx=t,console.log(" store updated state.selectedYearIdx "+e.selectedYearIdx)},updateSelectedWeekIdx:function(e,t){e.selectedWeekIdx=t,console.log(" store updated state.selectedWeekIdx "+e.selectedWeekIdx)},incrementForceComponentUpdateCounter:function(e){e.forceComponentUpdateCounter=e.forceComponentUpdateCounter+1}},actions:{login:function(e,t){var r=e.commit,a=t.loggedUserEmail;r("initLoggedUserEmail",a)},logout:function(e){var t=e.commit;t("RESET","")},initUserModifiedWeekMetrics:function(e){return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.state,console.log("START DISPATCH initUserModifiedWeekMetrics"),t.next=4,m.sendToModifiedWeekMetrics({transaction:"select_modifiedweekmetrics",userEMail:r.userDataObj.userEMail}).then((function(e){console.log("modifiedWeekMetricsDBrows"),console.log(e);var t,a=Object(s["a"])(e);try{var n=function(){var e=t.value,a=r.userDataObj.parcels.findIndex((function(t){return t.parcelName===e.parcelName&&t.dataOwnerEMail===e.dataOwnerEMail})),s=r.userDataObj.parcels[0].parcelYears.findIndex((function(t){return t.yearNumber===e.yearNumber})),n=r.userDataObj.parcels[0].parcelYears[0].yearWeeks.findIndex((function(t){return t.weekNumber===e.weekNumber}));e.modified=!0,r.userModifiedWeekMetrics.set("pIdx:".concat(a," yIdx:").concat(s," wIdx:").concat(n),e)};for(a.s();!(t=a.n()).done;)n()}catch(o){a.e(o)}finally{a.f()}console.log("state.userModifiedWeekMetrics"),console.log(r.userModifiedWeekMetrics)}));case 4:console.log("END DISPATCH initUserModifiedWeekMetrics");case 5:case"end":return t.stop()}}),t)})))()},saveSelectedWeekMetric:function(e,t){return Object(n["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e.state,t.modified=!0,a.userModifiedWeekMetrics.set("pIdx:".concat(a.selectedParcelIdx," yIdx:").concat(a.selectedYearIdx," wIdx:").concat(a.selectedWeekIdx),t),!a.demoUserEmail){r.next=6;break}return console.log(" saveSelectedWeekMetric: update are kept only for the time of the user session"),r.abrupt("return");case 6:t.transaction="alter_modifiedweekmetrics",m.sendToModifiedWeekMetrics(t).then((function(e){console.log("Inserted or Updated affectedRows in TABLE modifiedWeekMetrics"+e)}));case 8:case"end":return r.stop()}}),r)})))()},deleteSelectedWeekMetric:function(e,t){return Object(n["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e.state,!t.modified){r.next=10;break}if(a.userModifiedWeekMetrics.delete("pIdx:".concat(a.selectedParcelIdx," yIdx:").concat(a.selectedYearIdx," wIdx:").concat(a.selectedWeekIdx),t),!a.demoUserEmail){r.next=6;break}return console.log(" deleteSelectedWeekMetric: delete are considered only for the time of the user session"),r.abrupt("return");case 6:t.transaction="delete_modifiedweekmetrics",m.sendToModifiedWeekMetrics(t).then((function(e){console.log("Deleted affectedRows in TABLE modifiedWeekMetrics"+e)})),r.next=11;break;case 10:console.log(" week metric have not been modified it will deleted userModifiedWeekMetrics or in BD ");case 11:case"end":return r.stop()}}),r)})))()}}}),f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("div",{attrs:{id:"header "}},[r("my-header")],1),"/"!==e.$router.currentRoute.path?r("div",{attrs:{id:"navbar"}},[r("navbar")],1):e._e(),r("router-view"),r("div",{attrs:{id:"footer "}},[r("my-footer")],1)],1)},g=[],w=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},k=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"footer"},[r("div",{staticClass:"zoom"},[r("a",{staticClass:"btn-floating btn-sm btn-fb mx-1",attrs:{href:"http://www.inrae.fr",target:"_blank"}},[r("i",[r("img",{staticClass:"icone",attrs:{src:"images/inrae.png",target:"_blank"}})])]),r("a",{staticClass:"btn-floating btn-sm btn-fb mx-1",attrs:{href:"https://www.hdigitag.fr/fr/ ",target:"_blank"}},[r("i",[r("img",{staticClass:"icone",attrs:{src:"images/Digitag.png"}})])]),r("a",{staticClass:"btn-floating btn-sm btn-fb mx-1",attrs:{href:"https://muse.edu.umontpellier.fr/",target:"_blank"}},[r("i",[r("img",{staticClass:"icone",attrs:{src:"images/Logo_MUSE.png"}})])])]),r("div",{staticClass:"copyright "},[e._v(" © 2020 Copyright: "),r("a",{attrs:{href:"https://www.inrae.fr/centres/occitanie-montpellier",target:"_blank"}},[e._v(" INRAE OCCITANIE MONTPELLIER")])])])}],x={name:"Footer",components:{}},y=x,_=(r("6e1e"),r("2877")),O=Object(_["a"])(y,w,k,!1,null,"4712d85d",null),I=O.exports,j=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},M=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"header",staticStyle:{"background-image":"url(images/imagee.png)","background-size":"2000px 800px"}},[r("h1",[e._v("ApeX Territoire")])])}],C={name:"Header",components:{}},$=C,S=(r("c4c2"),Object(_["a"])($,j,M,!1,null,"0d5019dd",null)),D=S.exports,W=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.$store.state.activedNavbar?r("div",{staticClass:"topnav"},[0===e.$store.state.navbarModel?r("div",[r("router-link",{staticClass:"nav-link",attrs:{to:"/map"}},[e._v("Carte")]),r("router-link",{staticClass:"nav-link",attrs:{to:"/edit"}},[e._v("Editer")]),r("router-link",{staticClass:"nav-link",attrs:{to:"/partage"}},[e._v("Partager")]),r("router-link",{staticClass:"nav-link",attrs:{to:"/export"}},[e._v("Exporter")]),r("router-link",{staticClass:"nav-link",attrs:{to:"/profil"}},[e._v("Authentification")]),r("router-link",{staticClass:"nav-link",attrs:{to:"/guide"}},[e._v("Guide")]),r("a",{staticClass:"nav-link",attrs:{id:"exit",href:""},on:{click:e.logout}},[e._v("Déconnexion")])],1):r("div",[r("b-navbar",{staticStyle:{width:"100%"},attrs:{toggleable:"",type:"dark",variant:"dark"}},[r("b-navbar-brand",{attrs:{href:"#"}},[e._v("Menu")]),r("b-navbar-toggle",{attrs:{target:"navbar-toggle-collapse"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.expanded;return[r("b-icon",t?{attrs:{icon:"chevron-bar-up"}}:{attrs:{icon:"chevron-bar-down"}})]}}],null,!1,1828389767)}),r("b-collapse",{attrs:{id:"navbar-toggle-collapse","is-nav":""}},[r("b-navbar-nav",{staticClass:"ml-auto"},[r("b-nav-item",{attrs:{href:"#/map"}},[e._v("Carte")]),r("b-nav-item",{attrs:{href:"#/edit"}},[e._v("Editer")]),r("b-nav-item",{attrs:{href:"#/partage"}},[e._v("Partager")]),r("b-nav-item",{attrs:{href:"#/export"}},[e._v("Exporter")]),r("b-nav-item",{attrs:{href:"#/profil"}},[e._v("Authentification")]),r("b-nav-item",{attrs:{href:"#/guide"}},[e._v("Guide")]),r("b-nav-item",{attrs:{href:""},on:{click:e.logout}},[e._v("Déconnexion")])],1)],1)],1)],1)]):e._e()},P=[],N={name:"NavBar",components:{},created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:window.innerWidth<900&&(r=1,e.$store.commit("initNavbarModel",r)),window.innerWidth>=900&&(a=0,e.$store.commit("initNavbarModel",a));case 2:case"end":return t.stop()}}),t)})))()},methods:{logout:function(){this.$store.dispatch("logout");var e="";this.$store.commit("initmailpresent",e);var t="";this.$store.commit("initPasswordRequire",t);var r="";this.$store.commit("initActivedNavbar",r);var a=0;this.$store.commit("initNavbarModel",a),this.$router.push("/")}}},E=N,U=(r("05ee"),Object(_["a"])(E,W,P,!1,null,"66727a15",null)),L=U.exports,A={name:"App",components:{"my-footer":I,"my-header":D,navbar:L}},Y=A,R=(r("034f"),Object(_["a"])(Y,f,g,!1,null,null,null)),G=R.exports,T=r("8c4f"),B=function(){var e=this,t=e.$createElement,r=e._self._c||t;return null!==e.$store.state.userDataObj?r("div",{staticClass:"global",attrs:{id:"ApexMap"}},[r("div",{staticClass:"menu"},[r("div",{attrs:{id:"campagne "}},[e._v(" campagne : "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedYearIdx,expression:"selectedYearIdx"}],staticClass:"custom-select",staticStyle:{width:"auto"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedYearIdx=t.target.multiple?r:r[0]}}},e._l(e.$store.getters.yearNumberList,(function(t,a){return r("option",{key:a,domProps:{value:a}},[e._v(" "+e._s(t)+" ")])})),0)]),r("div",{attrs:{id:"semaine"}},[e._v(" semaine : "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedWeekIdx,expression:"selectedWeekIdx"}],staticClass:"custom-select",staticStyle:{width:"auto"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedWeekIdx=t.target.multiple?r:r[0]}}},e._l(e.$store.getters.weekLabelList,(function(t,a){return r("option",{key:a,domProps:{value:a}},[e._v(" "+e._s(t)+" ")])})),0)]),r("div",{attrs:{id:" parcelle"}},[e._v(" parcelle : "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedParcelIdx,expression:"selectedParcelIdx"}],staticClass:"custom-select",staticStyle:{width:"auto"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedParcelIdx=t.target.multiple?r:r[0]}}},e._l(e.$store.getters.parcelNameList,(function(t,a){return r("option",{key:a,domProps:{value:a}},[e._v(" "+e._s(t)+" ("+e._s(e.$store.state.userDataObj.parcels[a].dataOwnerName)+") ")])})),0)]),r("div",{attrs:{id:"campagnepr"}},[r("button",{staticClass:"btn btn-dark",attrs:{id:"viewPrevYear"},on:{mouseover:function(t){return e.showPrevYear(!0)},mouseout:function(t){return e.showPrevYear(!1)}}},[r("i",{staticClass:"far fa-eye"}),e._v(" campagne précédente ")]),r("p",[null!==e.msgPrevYear?r("label",[e._v(" "+e._s(e.msgPrevYear)+" ")]):e._e()])])]),r("hr"),r("div",{staticClass:"map"},["debug"===e.$store.state.viewMode?r("div",{staticClass:"headermap"},[r("p",{staticClass:"text"},[e._v(" "+e._s("nbObsFullGrowth: "+e.$store.getters.getSelectedWeekMetric.nbObsFullGrowth+", nbObsSlowGrowth: "+e.$store.getters.getSelectedWeekMetric.nbObsSlowGrowth+", nbObsStoppedGrowth: "+e.$store.getters.getSelectedWeekMetric.nbObsStoppedGrowth+", (modified: "+e.$store.getters.getSelectedWeekMetric.modified+")")+" ")]),r("p",{staticClass:"text"},[e._v(" "+e._s("currentzoom: "+e.currentZoom+", currentCenter: "+e.currentCenter+")")+" ")])]):e._e(),r("div",{staticClass:"bodymap"},[r("l-map",{ref:"parcelInfoMap",staticStyle:{height:"100%"},attrs:{zoom:e.currentZoom,center:e.currentCenter,options:e.mapOptions},on:{"update:center":e.centerUpdate,"update:zoom":e.zoomUpdate}},[r("l-tile-layer",{attrs:{url:e.url,attribution:e.attribution}}),e._l(e.$store.state.userDataObj.parcels,(function(t,a){return r("div",{key:a,staticClass:"parcels",attrs:{item:t,index:a}},[r("l-marker",{attrs:{"lat-lng":e.getLatLng(t.parcelCoord),icon:e.createIcon(a)},on:{click:function(t){return e.parcelMarkerClick(a)}}},[r("l-popup",[r("div",[r("p",{staticClass:"text"},[r("b",[e._v(" parcelle")]),e._v(" : "+e._s(t.parcelName)+" "),r("br"),r("b",[e._v("observateur")]),e._v(" : "+e._s(t.dataOwnerName)+" "),r("br"),r("b",[e._v("semaine du ")]),e._v(": "+e._s(e.$store.getters.weekLabelList[e.selectedWeekIdx])+" "+e._s(e.$store.getters.yearNumberList[e.selectedYearIdx])),r("br"),e.$store.getters.getSelectedWeekMetricTotalNbObs>0?[r("b",[e._v("Contrainte hydrique")]),e._v(" : "+e._s(e.$store.getters.getSelectedWeekMetricHydricConstraint)+" "),r("br"),r("b",[e._v("Indice de croissance")]),e._v(" : "+e._s(e.$store.getters.getSelectedWeekMetricAvgGrowth)+" "),r("br"),r("b",[e._v("observations")]),e._v(" : "+e._s(e.$store.getters.getSelectedWeekMetricTotalNbObs)+" "),r("br"),e._v(" # Pleine croissance : "+e._s(e.$store.getters.getSelectedWeekMetric.nbObsFullGrowth)+" "),r("br"),e._v(" # Croissance ralentie : "+e._s(e.$store.getters.getSelectedWeekMetric.nbObsSlowGrowth)+" "),r("br"),e._v(" # Croissance arrêtée : "+e._s(e.$store.getters.getSelectedWeekMetric.nbObsStoppedGrowth)+" "),r("br")]:[e._v(" (pas d'observations)"),r("br")],r("router-link",{staticClass:"nav-link",staticStyle:{"text-align":"right"},attrs:{to:"/edit"}},[e._v("éditer")])],2)])])],1)],1)}))],2)],1)]),r("div",{staticClass:"graphe"},[r("div",{attrs:{id:"title"}},[r("p",{staticStyle:{"font-size":"20px"}},[e._v(" parcelle: "+e._s(this.$store.getters.parcelNameList[this.$store.state.selectedParcelIdx])+" ")])]),r("hr"),r("div",{attrs:{id:"graphe1"}},[r("p",{staticStyle:{"font-size":"15px"}},[e._v(" croissance des apex semaine du "+e._s(this.$store.getters.weekLabelList[this.$store.state.selectedWeekIdx])+" "+e._s(this.$store.getters.yearNumberList[this.$store.state.selectedYearIdx])+" ")]),r("apex-growth-pie-chart",{staticClass:"item"})],1),r("hr"),r("div",{attrs:{id:"graphe2"}},[r("p",{staticStyle:{"font-size":"15px"}},[e._v(" évolution de la croissance des apex "+e._s(this.$store.getters.yearNumberList[this.$store.state.selectedYearIdx])+" "),r("apex-growth-line-chart",{staticClass:"item"})],1)]),r("hr"),r("div",{attrs:{id:"graphe3"}},[r("p",{staticStyle:{"font-size":"15px"}},[e._v(" évolution de la contrainte hydrique "+e._s(this.$store.getters.yearNumberList[this.$store.state.selectedYearIdx])+" "),r("apex-hydric-constraint-line-chart",{staticClass:"item"})],1)]),r("hr"),r("router-link",{staticClass:"nav-link",attrs:{to:"/edit"}},[e._v("éditer")])],1)]):e._e()},F=[],q=r("e11e"),z=r("2699"),H=r("a40a"),V=r("4e2b"),J=r("f60f"),X=function(){function e(){Object(i["a"])(this,e)}return Object(c["a"])(e,null,[{key:"avgGrowthToGreenColor",value:function(e){return e<0?"gray":e<=.125?"green_0":e<=.375?"green_25":e<=.625?"green_50":e<=.875?"green_75":e<=1?"green_100":"gray"}}]),e}(),Z=X,Q=r("1fca"),K={extends:Q["b"],mixins:[Q["c"].reactiveData],name:"ApexGrowthPieChart",data:function(){return{chartData:{labels:["% Pleine croissance   ","% Croissance ralentie","% Croissance arrétée"],datasets:[{data:[0,0,0],label:"croissance des apex",backgroundColor:["#2C6109","#6E9624","#C5DC68"],borderColor:["rgba(255, 255, 255, 1)","rgba(255, 255, 255, 1)","rgba(255, 255, 255, 1)"],borderWidth:1}]},chartNoData:{labels:["pas d'observations"],datasets:[{data:[-1],label:"croissance des apex",backgroundColor:["#cccccc"],borderColor:["rgba(255, 255, 255, 1)"],borderWidth:1}]},options:{animation:{duration:0},responsive:!0,maintainAspectRatio:!1,legend:{position:"right",onClick:function(e){return e.stopPropagation()}}}}},mounted:function(){var e=this;this.$nextTick((function(){e.$store.commit("incrementForceComponentUpdateCounter")}))},computed:{selectedWeekPieData:{get:function(){var e=this.$store.state.forceComponentUpdateCounter,t=this.$store.getters.getSelectedWeekMetric,r=parseInt(t.nbObsFullGrowth),a=parseInt(t.nbObsSlowGrowth),s=parseInt(t.nbObsStoppedGrowth),n=0,o=0,i=0,c=r+a+s;c>0&&(n=Math.round(r/c*100),o=Math.round(a/c*100),i=Math.round(s/c*100));var l={nbTotalObs:c,prctGrowthList:[n,o,i],forcedChartUpdateCounter:e};return l}}},watch:{selectedWeekPieData:function(e){e.nbTotalObs>0?(this.chartData.datasets[0].data=e.prctGrowthList,this.renderChart(this.chartData,this.options)):(this.chartNoData.datasets[0].data=[-1],this.renderChart(this.chartNoData,this.options))}}},ee={extends:Q["a"],mixins:[Q["c"].reactiveData],name:"ApexGrowthLineChart",data:function(){return{chartData:{labels:[],datasets:[{label:"Indice croiss.",yAxisID:"A",fill:!1,lineTension:.1,backgroundColor:"rgba(242, 142, 146, 0.2)",borderColor:"rgb(242, 142, 146)",borderCapStyle:"square",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"black",pointBackgroundColor:"white",pointBorderWidth:1,pointHoverRadius:8,pointHoverBackgroundColor:"rgb(242, 142, 146)",pointHoverBorderColor:"white",pointHoverBorderWidth:2,pointRadius:4,pointHitRadius:10,data:[]},{label:"% pleine",yAxisID:"B",fill:!0,hidden:!0,lineTension:.1,backgroundColor:"rgba(247, 201, 161, 0.2)",borderColor:"rgb(247, 201, 161)",borderCapStyle:"square",borderDash:[5,5],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"black",pointBackgroundColor:"white",pointBorderWidth:1,pointHoverRadius:8,pointHoverBackgroundColor:"rgb(247, 201, 161)",pointHoverBorderColor:"white",pointHoverBorderWidth:2,pointRadius:4,pointHitRadius:10,data:[]},{label:"% ralentie",yAxisID:"B",fill:!0,hidden:!1,lineTension:.1,backgroundColor:"rgba(144, 190, 184, 0.2)",borderColor:"rgb(144, 190, 184)",borderCapStyle:"square",borderDash:[5,5],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"black",pointBackgroundColor:"white",pointBorderWidth:1,pointHoverRadius:8,pointHoverBackgroundColor:"rgb(144, 190, 184)",pointHoverBorderColor:"white",pointHoverBorderWidth:2,pointRadius:4,pointHitRadius:10,data:[]},{label:"% arrétée",yAxisID:"B",fill:!0,hidden:!0,lineTension:.1,backgroundColor:"rgba(105, 134, 143, 0.2)",borderColor:"rgb(105, 134, 143)",borderCapStyle:"square",borderDash:[5,5],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"black",pointBackgroundColor:"white",pointBorderWidth:1,pointHoverRadius:8,pointHoverBackgroundColor:"rgb(105, 134, 143)",pointHoverBorderColor:"white",pointHoverBorderWidth:2,pointRadius:4,pointHitRadius:10,data:[]}]},options:{responsive:!0,maintainAspectRatio:!1,legend:{position:"bottom"},scales:{xAxes:[{ticks:{suggestedMax:12}}],yAxes:[{id:"A",type:"linear",position:"left",scaleLabel:{display:!0,labelString:"Indice croiss.",fontSize:11},ticks:{max:1,min:0,stepSize:.25}},{id:"B",type:"linear",position:"right",scaleLabel:{display:!0,labelString:"% Apex",fontSize:11},ticks:{max:100,min:0,stepSize:25}}]}}}},mounted:function(){var e=this;this.$nextTick((function(){e.$store.commit("incrementForceComponentUpdateCounter")}))},computed:{selectedParcelYearWeeksGrowthData:{get:function(){for(var e=this.$store.state.selectedParcelIdx,t=this.$store.state.selectedYearIdx,r=this.$store.state.forceComponentUpdateCounter,a=[],s=[],n=[],o=[],i=this.$store.getters.weekLabelList,c=i.length,l=0;l<c;l++){var d=this.$store.getters.getWeekMetric(e,t,l),u=parseInt(d.nbObsFullGrowth),p=parseInt(d.nbObsSlowGrowth),m=parseInt(d.nbObsStoppedGrowth),h=0,b=0,v=0,f=0,g=u+p+m;g>0&&(h=Math.round(u/g*100),b=Math.round(p/g*100),v=Math.round(m/g*100),f=(.5*b+h)/100),a.push(h),s.push(b),n.push(v),o.push(f)}var w={weekLabelList:i,prctFullGrowth:a,prctSlowGrowth:s,prctStoppedGrowth:n,icApex:o,forcedChartUpdateCounter:r};return w}}},watch:{selectedParcelYearWeeksGrowthData:function(e){this.chartData.labels=e.weekLabelList,this.chartData.datasets[0].data=e.icApex,this.chartData.datasets[1].data=e.prctFullGrowth,this.chartData.datasets[2].data=e.prctSlowGrowth,this.chartData.datasets[3].data=e.prctStoppedGrowth,this.renderChart(this.chartData,this.options)}}},te={extends:Q["a"],mixins:[Q["c"].reactiveData],name:"ApexHydricConstraintLineChart",data:function(){return{chartData:{labels:[],datasets:[{label:"Niveau contrainte hydrique",yAxisID:"CH",fill:!0,steppedLine:"middle",lineTension:.1,backgroundColor:"rgba(151, 162, 191, 0.2)",borderColor:"rgb(151, 162, 191)",borderCapStyle:"square",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"black",pointBackgroundColor:"white",pointBorderWidth:1,pointHoverRadius:8,pointHoverBackgroundColor:"rgb(151, 162, 191)",pointHoverBorderColor:"white",pointHoverBorderWidth:2,pointRadius:4,pointHitRadius:10,data:[]}]},options:{responsive:!0,maintainAspectRatio:!1,legend:{position:"bottom"},scales:{xAxes:[{ticks:{suggestedMax:10}}],yAxes:[{id:"CH",type:"linear",position:"left",ticks:{max:3,min:0,stepSize:1,callback:function(e){switch(e){case 0:return"Absente";case 1:return"Modérée";case 2:return"Forte";case 3:return"Sévère"}}}}]}}}},mounted:function(){var e=this;this.$nextTick((function(){e.$store.commit("incrementForceComponentUpdateCounter")}))},computed:{selectedParcelYearWeeksHydricConstraint:{get:function(){for(var e=this.$store.state.forceComponentUpdateCounter,t=[],r=this.$store.state.selectedParcelIdx,a=this.$store.state.selectedYearIdx,s=this.$store.getters.weekLabelList,n=s.length,o=0;o<n;o++){var i=this.$store.getters.getWeekMetric(r,a,o),c=parseInt(i.nbObsFullGrowth),l=parseInt(i.nbObsSlowGrowth),d=parseInt(i.nbObsStoppedGrowth),u=0,p=0,m=0,h=c+l+d;h>0&&(u=Math.round(c/h*100),p=Math.round(l/h*100),m=(.5*p+u)/100);var b=3;m>=.75?b=0:p>=5?b=1:p<=90&&(b=2),h<=0&&(b=0),t.push(b)}var v={weekLabelList:s,hydricContraintList:t,forcedChartUpdateCounter:e};return v}}},watch:{selectedParcelYearWeeksHydricConstraint:function(e){this.chartData.labels=e.weekLabelList,this.chartData.datasets[0].data=e.hydricContraintList,this.renderChart(this.chartData,this.options)}}};r("f9e3"),r("2dd8");delete q["Icon"].Default.prototype._getIconUrl,q["Icon"].Default.mergeOptions({iconRetinaUrl:r("584d"),iconUrl:r("6397"),shadowUrl:r("e2b9")});var re={name:"ApexMap",components:{LMap:z["a"],LTileLayer:H["a"],LMarker:V["a"],LPopup:J["a"],ApexGrowthPieChart:K,ApexGrowthLineChart:ee,ApexHydricConstraintLineChart:te},data:function(){return{selectedParcelIdx:0,selectedYearIdx:0,selectedWeekIdx:0,url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",currentZoom:18,currentCenter:Object(q["latLng"])(43.6452,3.87189),mapOptions:{zoomSnap:.5},prevYearIsShowned:!1,msgPrevYear:null}},created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.state.loggedUserEmail||e.$router.push("/"),e.selectedParcelIdx=e.$store.state.selectedParcelIdx,e.selectedYearIdx=e.$store.state.selectedYearIdx,e.selectedWeekIdx=e.$store.state.selectedWeekIdx;case 4:case"end":return t.stop()}}),t)})))()},mounted:function(){this.$store.state.loggedUserEmail||this.$router.push("/"),this.selectedParcelIdx=this.$store.state.selectedParcelIdx,this.selectedYearIdx=this.$store.state.selectedYearIdx,this.selectedWeekIdx=this.$store.state.selectedWeekIdx,this.$store.commit("incrementForceComponentUpdateCounter")},watch:{selectedParcelIdx:function(e){console.log(" watch update selectedParcelIdx val"),console.log(e),this.$store.commit("updateSelectedParcelIdx",e),this.parcelMarkerClick(e)},selectedYearIdx:function(e){console.log(" watch update selectedYearIdx val"),console.log(e),this.$store.commit("updateSelectedYearIdx",e)},selectedWeekIdx:function(e){console.log(" watch update selectedWeekIdx val"),console.log(e),this.$store.commit("updateSelectedWeekIdx",e)},currentCenter:function(e){this.$refs.parcelInfoMap.setCenter(e)}},methods:{zoomUpdate:function(e){this.currentZoom=e},centerUpdate:function(e){this.currentCenter=e},innerClick:function(){alert("Click!")},getLatLng:function(e){return Object(q["latLng"])(e.lat,e.lng)},parcelMarkerClick:function(e){console.log("parcelMarkerClick pIdx: "+e),e!==this.selectedParcelIdx&&(this.selectedParcelIdx=parseInt(e));var t=this.$store.state.userDataObj.parcels[e].parcelCoord.lat,r=this.$store.state.userDataObj.parcels[e].parcelCoord.lng;this.currentCenter=Object(q["latLng"])(t,r)},showPrevYear:function(e){e?0===this.selectedYearIdx?this.msgPrevYear="pas d'observations avant "+this.$store.getters.yearNumberList[this.selectedYearIdx]:(this.selectedYearIdx=this.selectedYearIdx-1,this.prevYearIsShowned=e):(this.prevYearIsShowned&&(this.selectedYearIdx=this.selectedYearIdx+1,this.prevYearIsShowned=e),this.msgPrevYear=null)},createIcon:function(e){var t=-1,r=this.$store.getters.getTotalNbObs(e,this.selectedYearIdx,this.selectedWeekIdx);r>0&&(t=this.$store.getters.getAvgGrowth(e,this.selectedYearIdx,this.selectedWeekIdx),t=Math.round(100*t)/100),console.log("createIcon pIdx: "+e+" avgGrowth: "+t);var a=Z.avgGrowthToGreenColor(t);return!0===this.prevYearIsShowned&&(console.log(" color pin border : "),a+="_bordered"),new q["Icon"]({iconUrl:"images/my_"+a+"_pin.png",iconSize:[22,35],iconAnchor:[0,0],popupAnchor:[0,0]})}}},ae=re,se=(r("a3c9"),Object(_["a"])(ae,B,F,!1,null,"66ad8e07",null)),ne=se.exports,oe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return null!==e.$store.state.userDataObj?r("div",{staticClass:"global"},[r("div",{staticClass:"meta"},[r("div",{staticClass:"title"},[r("hr"),r("h4",[e._v("Bonjour "+e._s(e.$store.getters.getDisplayedUserName))]),r("hr")]),r("div",{staticClass:"menu"},[r("div",{attrs:{id:"compagne"}},[r("b",[e._v("Compagne :")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedYearIdx,expression:"selectedYearIdx"}],staticClass:"custom-select",staticStyle:{width:"auto"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedYearIdx=t.target.multiple?r:r[0]}}},e._l(e.$store.getters.yearNumberList,(function(t,a){return r("option",{key:a,domProps:{value:a}},[e._v(e._s(t)+" ")])})),0)]),r("div",{attrs:{id:"semaine"}},[r("b",[e._v("semaine :")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedWeekIdx,expression:"selectedWeekIdx"}],staticClass:"custom-select",staticStyle:{width:"auto"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedWeekIdx=t.target.multiple?r:r[0]}}},e._l(e.$store.getters.weekLabelList,(function(t,a){return r("option",{key:a,domProps:{value:a}},[e._v(e._s(t)+" ")])})),0)]),r("div",{attrs:{id:"parcelle"}},[r("b",[e._v("parcelle :")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedParcelIdx,expression:"selectedParcelIdx"}],staticClass:"custom-select",staticStyle:{width:"auto"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedParcelIdx=t.target.multiple?r:r[0]}}},e._l(e.$store.getters.parcelNameList,(function(t,a){return r("option",{key:a,domProps:{value:a}},[e._v(e._s(t)+" ("+e._s(e.$store.getters.getDisplayedUserNameIfNeeded(e.$store.state.userDataObj.parcels[a].dataOwnerEMail,e.$store.state.userDataObj.parcels[a].dataOwnerName))+") ")])})),0)])]),r("div",{staticClass:"table"},[r("hr"),r("table",{staticClass:"table-striped"},[e._m(0),r("tbody",[r("td",[r("b-form-input",{staticStyle:{width:"auto","text-align":"center","margin-left":"auto","margin-right":"auto"},attrs:{type:"number"},model:{value:e.selectedWeekMetric.nbObsFullGrowth,callback:function(t){e.$set(e.selectedWeekMetric,"nbObsFullGrowth",t)},expression:"selectedWeekMetric.nbObsFullGrowth"}})],1),r("td",[r("b-form-input",{staticStyle:{width:"auto","text-align":"center","margin-left":"auto","margin-right":"auto"},attrs:{type:"number"},model:{value:e.selectedWeekMetric.nbObsSlowGrowth,callback:function(t){e.$set(e.selectedWeekMetric,"nbObsSlowGrowth",t)},expression:"selectedWeekMetric.nbObsSlowGrowth"}})],1),r("td",[r("b-form-input",{staticStyle:{width:"auto","text-align":"center","margin-left":"auto","margin-right":"auto"},attrs:{type:"number"},model:{value:e.selectedWeekMetric.nbObsStoppedGrowth,callback:function(t){e.$set(e.selectedWeekMetric,"nbObsStoppedGrowth",t)},expression:"selectedWeekMetric.nbObsStoppedGrowth"}})],1),r("td",[r("button",{staticClass:"btn btn-primary btn-sm",staticStyle:{"margin-right":"20px"},attrs:{id:"btnsendmodif"},on:{click:function(t){return e.updateSelectedWeekMetric()}}},[e._v(" Modifier ")]),r("button",{staticClass:"btn btn-warning btn-sm",attrs:{id:"btnsenddelete"},on:{click:function(t){return e.reInitSelectedWeekMetric()}}},[e._v(" Réinitialiser ")])])])]),r("hr")]),r("div",[e._v(" "+e._s(e.msg)+" "),e._l(e.errors,(function(t,a){return r("div",{key:a,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])}))],2)]),r("div",{staticClass:"btn"},[r("hr"),r("router-link",{staticClass:"btn btn-success btn-sm",staticStyle:{"margin-bottom":"20px"},attrs:{to:"/map",tag:"button"}},[e._v("Retour à la carte")]),r("hr")],1),r("div",{staticClass:"graphe"},[r("div",{attrs:{id:"titlegraphe"}},[r("p",{staticStyle:{"font-size":"20px"}},[e._v(" parcelle: "+e._s(this.$store.getters.parcelNameList[this.$store.state.selectedParcelIdx])+" ")])]),r("hr"),r("div",{attrs:{id:"graphe1"}},[r("p",{staticStyle:{"font-size":"20px"}},[e._v(" croissance des apex semaine du "+e._s(this.$store.getters.weekLabelList[this.$store.state.selectedWeekIdx])+" "+e._s(this.$store.getters.yearNumberList[this.$store.state.selectedYearIdx])+" ")]),r("apex-growth-pie-chart",{staticClass:"item"})],1),r("hr"),r("div",{attrs:{id:"graphe2"}},[r("p",{staticStyle:{"font-size":"20px"}},[e._v(" évolution de la croissance des apex "+e._s(this.$store.getters.yearNumberList[this.$store.state.selectedYearIdx])+" "),r("apex-growth-line-chart",{staticClass:"item"})],1)]),r("hr"),r("div",{attrs:{id:"graphe3"}},[e._v(" évolution de la contrainte hydrique "+e._s(this.$store.getters.yearNumberList[this.$store.state.selectedYearIdx])+" "),r("apex-hydric-constraint-line-chart",{staticClass:"item"})],1)])]):e._e()},ie=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("thead",[r("tr",[r("th",[e._v("# Pleine croissance")]),r("th",[e._v("# Croissance ralentie")]),r("th",[e._v("# Croissance arrêtée")]),r("th",{attrs:{colspan:"2"}},[e._v("Operations")])])])}],ce={components:{ApexGrowthPieChart:K,ApexGrowthLineChart:ee,ApexHydricConstraintLineChart:te},data:function(){return{selectedParcelIdx:0,selectedYearIdx:0,selectedWeekIdx:0,selectedWeekMetric:{},msg:"",errors:[]}},created:function(){this.$store.state.loggedUserEmail||this.$router.push("/"),this.selectedParcelIdx=this.$store.state.selectedParcelIdx,this.selectedYearIdx=this.$store.state.selectedYearIdx,this.selectedWeekIdx=this.$store.state.selectedWeekIdx,this.selectedWeekMetric=this.$store.getters.getSelectedWeekMetric},mounted:function(){this.$store.state.loggedUserEmail||this.$router.push("/"),this.selectedParcelIdx=this.$store.state.selectedParcelIdx,this.selectedYearIdx=this.$store.state.selectedYearIdx,this.selectedWeekIdx=this.$store.state.selectedWeekIdx,this.msg="",this.errors=[],this.selectedWeekMetric=this.$store.getters.getSelectedWeekMetric,this.$store.commit("incrementForceComponentUpdateCounter")},methods:{formIsValid:function(){var e=!0;return isNaN(parseInt(this.selectedWeekMetric.nbObsFullGrowth))?(this.errors.push("# Pleine croissance : '"+this.selectedWeekMetric.nbObsFullGrowth+"' n'est pas un entier "),e=!1):parseInt(this.selectedWeekMetric.nbObsFullGrowth)>=0?this.selectedWeekMetric.nbObsFullGrowth=parseInt(this.selectedWeekMetric.nbObsFullGrowth):(this.errors.push("# Pleine croissance : '"+this.selectedWeekMetric.nbObsFullGrowth+"' n'est pas un entier positif "),e=!1),isNaN(parseInt(this.selectedWeekMetric.nbObsSlowGrowth))?(this.errors.push("# Croissance ralentie : '"+this.selectedWeekMetric.nbObsSlowGrowth+"' n'est pas un entier"),e=!1):parseInt(this.selectedWeekMetric.nbObsSlowGrowth)>=0?this.selectedWeekMetric.nbObsSlowGrowth=parseInt(this.selectedWeekMetric.nbObsSlowGrowth):(this.errors.push("# Croissance ralentie  : '"+this.selectedWeekMetric.nbObsSlowGrowth+"' n'est pas un entier positif "),e=!1),isNaN(parseInt(this.selectedWeekMetric.nbObsStoppedGrowth))?(this.errors.push("# Croissance arretée : '"+this.selectedWeekMetric.nbObsStoppedGrowth+"' n' est pas un entier "),e=!1):parseInt(this.selectedWeekMetric.nbObsStoppedGrowth)>=0?this.selectedWeekMetric.nbObsStoppedGrowth=parseInt(this.selectedWeekMetric.nbObsStoppedGrowth):(this.errors.push("# Croissance arretée : '"+this.selectedWeekMetric.nbObsStoppedGrowth+"' n'est pas un entier positif "),e=!1),this.msg="Les données de la semaine n'ont pas été modifiées",e},updateSelectedWeekMetric:function(){var e=this;this.msg="",this.errors=[],console.log("START updateSelectedWeekMetric"),this.formIsValid()&&this.$store.dispatch("saveSelectedWeekMetric",this.selectedWeekMetric).then((function(){e.selectedWeekMetric=e.$store.getters.getSelectedWeekMetric,e.$store.commit("incrementForceComponentUpdateCounter"),e.errors=[],e.msg="Les données de la semaine ont bien été modifiées, ",e.$store.state.demoUserEmail&&(e.msg+=" pour l'"+e.$store.getters.getDisplayedUserName+" ces modifications sont effectives que le temps de la session")})),console.log("END updateSelectedWeekMetric")},reInitSelectedWeekMetric:function(){var e=this;this.msg="",this.errors=[];var t=this.$store.getters.getSelectedWeekMetric,r="pIdx:".concat(this.selectedParcelIdx," yIdx:").concat(this.selectedYearIdx," wIdx:").concat(this.selectedWeekIdx);this.$store.state.userModifiedWeekMetrics.has(r)&&this.$store.dispatch("deleteSelectedWeekMetric",t).then((function(){e.selectedWeekMetric=e.$store.getters.getSelectedWeekMetric,e.$store.commit("incrementForceComponentUpdateCounter"),e.errors=[],e.msg="Les données de la semaine ont été réinitialisées aux valeurs collectées dans ApeX Vignes",e.$store.state.demoUserEmail&&(e.msg+=" pour l'"+e.$store.getters.getDisplayedUserName+" ces modifications sont effectives que le temps de la session")}))}},watch:{selectedParcelIdx:function(e){this.$store.commit("updateSelectedParcelIdx",e),this.selectedWeekMetric=this.$store.getters.getSelectedWeekMetric,this.msg="",this.errors=[]},selectedYearIdx:function(e){this.$store.commit("updateSelectedYearIdx",e),this.selectedWeekMetric=this.$store.getters.getSelectedWeekMetric,this.msg="",this.errors=[]},selectedWeekIdx:function(e){this.$store.commit("updateSelectedWeekIdx",e),this.selectedWeekMetric=this.$store.getters.getSelectedWeekMetric,this.msg="",this.errors=[]}}},le=ce,de=(r("25b2"),Object(_["a"])(le,oe,ie,!1,null,"390bebb0",null)),ue=de.exports,pe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"global"},[r("div",{staticClass:"title"},[r("hr"),r("h4",[e._v("Bonjour "+e._s(e.$store.getters.getDisplayedUserName))]),r("hr")]),r("div",{staticClass:"menu"},[r("h5",{attrs:{id:"menutitle"}},[r("b",[e._v("Nouveau partage des observations collectées par "+e._s(e.$store.getters.getDisplayedUserName)+" ")])]),r("div",{attrs:{id:"menuselect"}},[e._m(0),r("select",{directives:[{name:"model",rawName:"v-model",value:e.parcelp,expression:"parcelp"}],staticClass:"custom-select",staticStyle:{width:"auto"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.parcelp=t.target.multiple?r:r[0]}}},e._l(e.parcelNameListObservedByLoggedUser,(function(t,a){return r("option",{key:a,attrs:{item:t}},[e._v(" "+e._s(t)+" ")])})),0)]),r("div",{attrs:{id:"menuinput"}},[e._m(1),r("input",{directives:[{name:"model",rawName:"v-model",value:e.mailp,expression:"mailp"}],attrs:{type:"text",name:"mailp"},domProps:{value:e.mailp},on:{input:function(t){t.target.composing||(e.mailp=t.target.value)}}})]),r("div",{attrs:{id:"btn"}},[r("button",{staticClass:"btn btn-info btn-sm",attrs:{id:"buttonverif"},on:{click:function(t){return e.checkEMailAndParcel()}}},[e._v(" Vérifier ")]),r("button",{staticClass:"btn btn-success btn-sm",staticStyle:{weight:"auto"},attrs:{id:"buttoninsert"},on:{click:function(t){return e.insertParcelDataSharedToSomn()}}},[e._v(" Ajouter ")])])]),r("p",[e._v(e._s(e.message))]),r("hr"),r("div",{staticClass:"body"},[r("div",{staticClass:"obspartager"},[r("h5",[r("b",[e._v(" Liste des observations partagées par "+e._s(e.$store.getters.getDisplayedUserName)+" ")])]),r("table",{staticClass:"table-striped"},[e._m(2),r("tbody",e._l(e.parcelRowsSharedToSomeone,(function(t,a){return r("tr",{key:a,attrs:{index:a}},[r("td",[e._v(e._s(e.$store.getters.getDisplayedUserEMail))]),r("td",[e._v(e._s(t.dataUserEMail))]),r("td",[e._v(e._s(t.parcelName))]),r("td",[r("button",{staticClass:"btn btn-danger btn-sm",on:{click:function(r){return e.deleteParcelDataSharedToSomn(t.dataOwnerEMail,t.dataUserEMail,t.parcelName)}}},[e._v(" Supprimer ")])])])})),0)])]),r("hr"),r("div",{staticClass:"obsrecu"},[e._m(3),r("table",{staticClass:"table-striped"},[e._m(4),r("tbody",e._l(e.parcelRowsSharedBySomeone,(function(t,a){return r("tr",{key:a,attrs:{index:a}},[r("td",[e._v(e._s(t.dataOwnerEMail))]),r("td",[e._v(e._s(e.$store.getters.getDisplayedUserEMail))]),r("td",[e._v(e._s(t.parcelName))])])})),0)])])]),r("hr")])},me=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",[r("b",[e._v("Parcelle")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{staticStyle:{"margin-left":"10px"},attrs:{for:"mail"}},[r("b",[e._v("Mail Destinataire ")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("thead",[r("tr",[r("th",[e._v("Observateur")]),r("th",[e._v("Destinataire")]),r("th",[e._v("Parcelle")]),r("th",[e._v("Operation")])])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("h5",[r("b",[e._v("Liste des observations partagées par un autre utilisateur")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("thead",[r("tr",[r("th",[e._v("Observateur")]),r("th",[e._v("Destinataire")]),r("th",[e._v("Parcelle")])])])}],he={name:"App",components:{},data:function(){return{dataOwnerEMail:"",dataUserEMail:"",parcelName:"",date:"",userDataObj:[],userDBRows:[],error:"",text:"",pIdx:0,yIdx:"",wIdx:"",message:"",parcelp:"",mailp:"",parcelRowsSharedToSomeone:[],parcelRowsSharedBySomeone:[]}},created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$store.state.loggedUserEmail||e.$router.push("/"),t.prev=1,t.next=4,m.sendToParcelDataSharing({transaction:"select_parceldatasharing",ownerEMail:e.$store.state.loggedUserEmail});case 4:return e.parcelRowsSharedToSomeone=t.sent,console.log("parcelRowsSharedToSomeone"),console.log(e.parcelRowsSharedToSomeone),t.next=9,m.sendToParcelDataSharing({transaction:"select_parceldatasharing",userEMail:e.$store.state.loggedUserEmail});case 9:e.parcelRowsSharedBySomeone=t.sent,console.log("parcelRowsSharedBySomeone"),console.log(e.parcelRowsSharedBySomeone),t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](1),console.log(t.t0.message),e.error=t.t0.message;case 18:case"end":return t.stop()}}),t,null,[[1,14]])})))()},computed:{parcelNameListObservedByLoggedUser:function(){var e=this;return null!==this.$store.state.userDataObj&&null!==this.$store.state.userDataObj.parcels?this.$store.state.userDataObj.parcels.map((function(t){if(t.dataOwnerEMail===e.$store.state.userDataObj.userEMail)return t.parcelName})):[]}},methods:{checkEMailAndParcel:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.message="",t.abrupt("return",new Promise((function(t,r){if(e.$store.state.demoUserEmail)e.message=e.$store.getters.getDisplayedUserEMail+" n'est pas authorisé à ajouter de nouveaux partages",t(!1);else{var a,n=!1,o=Object(s["a"])(e.parcelRowsSharedToSomeone);try{for(o.s();!(a=o.n()).done;){var i=a.value;i.dataOwnerEMail===e.$store.state.loggedUserEmail&&i.dataUserEMail===e.mailp&&i.parcelName===e.parcelp&&(e.message="Les informations de la parcelle sont déjà partagées avec l'utilisateur",n=!0)}}catch(c){o.e(c)}finally{o.f()}if(n)t(!1);else try{m.checkEMail(e.mailp).then((function(r){!0===r?e.parcelp?(e.message="La parcelle et le mail sont valides",e.parcelName=e.parcelp,t(!0)):(e.message="Choisir la parcelle",t(!1)):(e.message="Mail non valide",e.parcelName="",t(!0))}))}catch(c){r(c)}}})));case 2:case"end":return t.stop()}}),t)})))()},insertParcelDataSharedToSomn:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$store.state.demoUserEmail){t.next=3;break}return e.message=e.$store.getters.getDisplayedUserName+" n'est pas authorisé à ajouter de nouveaux partages, connectez-vous en tant qu'utilisateur",t.abrupt("return");case 3:return console.log("START insertParcelDataSharedToSomn"),t.next=6,e.checkEMailAndParcel(e.mailp);case 6:if(r=t.sent,console.log("mailAndParcelAreValid "+r),!r){t.next=17;break}return t.next=11,m.sendToParcelDataSharing({transaction:"insert_parceldatasharing",dataUserEMail:e.mailp,dataOwnerEMail:e.$store.state.userDataObj.userEMail,parcelName:e.parcelp});case 11:return a=t.sent,console.log("res insert_parceldatasharing "+a),t.next=15,m.sendToParcelDataSharing({transaction:"select_parceldatasharing",ownerEMail:e.$store.state.userDataObj.userEMail});case 15:e.parcelRowsSharedToSomeone=t.sent,e.message="La parcelle et le mail destinataire ont été ajouté";case 17:console.log("END insertParcelDataSharedToSomn");case 18:case"end":return t.stop()}}),t)})))()},deleteParcelDataSharedToSomn:function(e,t,r){var a=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(!a.$store.state.demoUserEmail){s.next=3;break}return a.message=a.$store.getters.getDisplayedUserName+" n'est pas authorisé à supprimer les informations de partage",s.abrupt("return");case 3:return s.next=5,m.sendToParcelDataSharing({transaction:"delete_parceldatasharing",dataUserEMail:t,dataOwnerEMail:e,parcelName:r});case 5:return s.next=7,m.sendToParcelDataSharing({transaction:"select_parceldatasharing",ownerEMail:a.$store.state.userDataObj.userEMail});case 7:a.parcelRowsSharedToSomeone=s.sent;case 8:case"end":return s.stop()}}),s)})))()}},watch:{selectedParcelIdx:function(e){this.$store.commit("updateSelectedParcelIdx",e)}}},be=he,ve=(r("20c6"),Object(_["a"])(be,pe,me,!1,null,"07a44246",null)),fe=ve.exports,ge=function(){var e=this,t=e.$createElement,r=e._self._c||t;return null!==e.$store.state.userDataObj?r("div",{staticClass:"global"},[r("br"),r("div",{staticClass:"title"},[r("hr"),r("h4",[e._v("Bonjour "+e._s(e.$store.getters.getDisplayedUserName))]),r("hr")]),r("div",{staticClass:"menu"},[r("div",{attrs:{id:"compagne"}},[r("b",[e._v("Compagne :")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedYearIdx,expression:"selectedYearIdx"}],staticClass:"custom-select",staticStyle:{width:"auto"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedYearIdx=t.target.multiple?r:r[0]}}},e._l(e.$store.getters.yearNumberList,(function(t,a){return r("option",{key:a,domProps:{value:a}},[e._v(e._s(t)+" ")])})),0)]),r("div",{attrs:{id:"semaine"}},[r("b",[e._v("semaine :")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedWeekIdx,expression:"selectedWeekIdx"}],staticClass:"custom-select",staticStyle:{width:"auto"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedWeekIdx=t.target.multiple?r:r[0]}}},e._l(e.$store.getters.weekLabelList,(function(t,a){return r("option",{key:a,domProps:{value:a}},[e._v(e._s(t)+" ")])})),0)]),r("div",{attrs:{id:"parcelle"}},[r("b",[e._v("parcelle :")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedParcelIdx,expression:"selectedParcelIdx"}],staticClass:"custom-select",staticStyle:{width:"auto"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedParcelIdx=t.target.multiple?r:r[0]}}},e._l(e.$store.getters.parcelNameList,(function(t,a){return r("option",{key:a,domProps:{value:a}},[e._v(e._s(t)+" ("+e._s(e.$store.getters.getDisplayedUserNameIfNeeded(e.$store.state.userDataObj.parcels[a].dataOwnerEMail,e.$store.state.userDataObj.parcels[a].dataOwnerName))+") ")])})),0)])]),r("div",{staticClass:"graphe",attrs:{id:"graphe"}},[r("div",{attrs:{id:"title"}},[r("p",{staticStyle:{"font-size":"20px"}},[e._v(" parcelle: "+e._s(this.$store.getters.parcelNameList[this.$store.state.selectedParcelIdx])+" ")])]),r("hr"),r("div",[r("p",{staticStyle:{"font-size":"20px"}},[e._v(" croissance des apex semaine du "+e._s(this.$store.getters.weekLabelList[this.$store.state.selectedWeekIdx])+" "+e._s(this.$store.getters.yearNumberList[this.$store.state.selectedYearIdx])+" ")]),r("apex-growth-pie-chart",{staticClass:"item",attrs:{id:"graphe1"}})],1),r("hr"),r("div",{attrs:{id:"graphe21"}},[e._v(" évolution de la croissance des apex "+e._s(this.$store.getters.yearNumberList[this.$store.state.selectedYearIdx])+" "),r("apex-growth-line-chart",{staticClass:"item",attrs:{id:"graphe2"}})],1),r("hr"),r("div",[e._v(" évolution de la contrainte hydrique "+e._s(this.$store.getters.yearNumberList[this.$store.state.selectedYearIdx])+" "),r("apex-hydric-constraint-line-chart",{staticClass:"item",attrs:{id:"graphe3"}})],1)]),r("div",{staticClass:"export",staticStyle:{"margin-top":"10px"}},[r("hr"),r("button",{staticClass:"btn btn-danger btn-sm",attrs:{id:"expdf"},on:{click:function(t){return e.exportPDF()}}},[e._v(" Export en PDF ")]),r("button",{staticClass:"btn btn-success btn-sm",attrs:{id:"excsv"},on:{click:function(t){return e.exportCSV()}}},[e._v(" Export en CSV ")]),r("hr")])]):e._e()},we=[],ke=r("e511"),xe=(r("0da4"),{name:"Export",components:{ApexGrowthPieChart:K,ApexGrowthLineChart:ee,ApexHydricConstraintLineChart:te},data:function(){return{userDataObj:[],userDBRows:[],error:"",selectedParcelIdx:0,selectedYearIdx:0,selectedWeekIdx:0,parceld:"",hydricConstraint:3,prctSlowGrowth:0,prctFullGrowth:0,avgGrowth:0}},created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.state.loggedUserEmail||e.$router.push("/"),e.selectedParcelIdx=e.$store.state.selectedParcelIdx,e.selectedYearIdx=e.$store.state.selectedYearIdx,e.selectedWeekIdx=e.$store.state.selectedWeekIdx;case 4:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;this.$store.state.loggedUserEmail||this.$router.push("/"),this.$nextTick((function(){e.selectedParcelIdx=e.$store.state.selectedParcelIdx,e.selectedYearIdx=e.$store.state.selectedYearIdx,e.selectedWeekIdx=e.$store.state.selectedWeekIdx,e.$store.commit("incrementForceComponentUpdateCounter")}))},methods:{getDataFrame:function(){for(var e=["Parcelle","Campagne","Semaine","Nb Obs.","Nb Pleine croiss.","Nb Croiss. ralentie","Nb Croiss. arrêtée","% Pleine croiss.","% Croiss. ralentie","% Croiss. arrêtée","ic-Apex","Contrainte hydrique"],t=[],r=this.$store.getters.weekLabelList,a=r.length,s=0;s<a;s++){var n=this.$store.getters.getWeekMetric(this.selectedParcelIdx,this.selectedYearIdx,s),o=parseInt(n.nbObsFullGrowth),i=parseInt(n.nbObsSlowGrowth),c=parseInt(n.nbObsStoppedGrowth),l=o+i+c,d=0,u=0,p=0,m=0;l>0&&(d=Math.round(o/l*100),u=Math.round(i/l*100),p=Math.round(c/l*100),m=(.5*u+d)/100);var h=3;m>=.75?h=0:u>=5?h=1:u<=90&&(h=2),l<=0&&(h=0);var b=[];b.push(this.$store.getters.parcelNameList[this.selectedParcelIdx]),b.push(this.$store.getters.yearNumberList[this.selectedYearIdx]),b.push(this.$store.getters.weekLabelList[s]),b.push(l),b.push(o),b.push(i),b.push(c),b.push(d),b.push(u),b.push(p),b.push(m),b.push(h),t.push(b)}var v={columns:e,rows:t};return console.log("DataFrame"),console.log(v),v},exportPDF:function(){var e=new ke("landscape"),t=document.getElementById("pie-chart"),r=document.getElementById("line-chart"),a=document.getElementById("graphe3").children[1],s=t.toDataURL(),n=r.toDataURL(),o=a.toDataURL();e.text(90,20," Parcelle "+this.$store.getters.parcelNameList[this.selectedParcelIdx]+" Observateur "+this.$store.getters.getDisplayedUserNameIfNeeded(this.$store.state.userDataObj.parcels[this.selectedParcelIdx].dataOwnerEMail,this.$store.state.userDataObj.parcels[this.selectedParcelIdx].dataOwnerName)),e.text(60,40," Indicateurs d'évolution de croissance des Apex pour la campagne "+this.$store.getters.yearNumberList[this.selectedYearIdx]),e.addImage(s,"NPG",10,60,60,60),e.addImage(n,"NPG",90,60,90,60),e.addImage(o,"NPG",210,60,60,60),e.text(10,130,"semaine du "+this.$store.getters.weekLabelList[this.selectedWeekIdx]),e.text(90,130,"évolution de la croissance "),e.text(200,130,"évolution de la contrainte hydrique"),e.addPage("a4","l"),e.text(60,10,"Table des indicateurs de croissance calculés pour la campagne "+this.$store.getters.yearNumberList[this.selectedYearIdx]);var i=this.getDataFrame();e.autoTable(i.columns,i.rows,{margin:{top:20,halign:"center"},rowStyles:{0:{halign:"center"}}}),e.save("table.pdf")},exportCSV:function(){var e=this.getDataFrame(),t="data:text/csv;charset=utf-8,\n";e.columns.forEach((function(e,r,a){return t=t+'"'+e+'"'+(r<a.length-1?",":"\n")})),e.rows.forEach((function(e){return e.forEach((function(e,r,a){return t=t+e+(r<a.length-1?",":"\n")}))})),console.log("csvContent"),console.log(t);var r=encodeURI(t),a=document.createElement("a");a.setAttribute("href",r),a.setAttribute("download","export.csv"),a.click()}},watch:{selectedParcelIdx:function(e){this.$store.commit("updateSelectedParcelIdx",e),this.parcelMarkerClick(e)},selectedYearIdx:function(e){this.$store.commit("updateSelectedYearIdx",e)},selectedWeekIdx:function(e){this.$store.commit("updateSelectedWeekIdx",e)}}}),ye=xe,_e=(r("8b49"),Object(_["a"])(ye,ge,we,!1,null,"1bdb4132",null)),Oe=_e.exports,Ie=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"global"},[r("br"),r("div",{staticClass:"menu"},[r("hr"),r("h4",{staticClass:"title",staticStyle:{"background-color":"grey"}},[e._v(" Bonjour "+e._s(e.$store.getters.getDisplayedUserName)+" ")]),r("hr"),r("p",[e._v("email: "+e._s(e.$store.getters.getDisplayedUserEMail))]),e.$store.state.demoUserEmail?r("div",[e._v(" "+e._s(e.$store.getters.getDisplayedUserName)+" ne peut pas changer ses données d'authentification ")]):r("div",[r("router-link",{staticClass:"btn btn-success btn-sm",staticStyle:{"margin-bottom":"20px"},attrs:{to:"/addpsw",tag:"button"}},[e._v("Ajouter/Modifier un mot de passe ")])],1)])])},je=[],Me={name:"App",components:{},props:{userId:String},computed:{},data:function(){return{}},created:function(){this.$store.state.loggedUserEmail||this.$router.push("/")},mounted:function(){this.$store.state.loggedUserEmail||this.$router.push("/")},methods:{}},Ce=Me,$e=(r("8171"),Object(_["a"])(Ce,Ie,je,!1,null,"a859c6e0",null)),Se=$e.exports,De=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"global"},[r("hr"),r("h4",{staticClass:"title",staticStyle:{"background-color":"grey"}},[e._v(" Bonjour "+e._s(e.$store.getters.getDisplayedUserName)+" ")]),r("hr"),e.$store.state.demoUserEmail?r("div",[r("h5",[e._v("Bienvenue sur l'application Apex Territoire")]),e._m(0),r("h5",[e._v("Objectifs")]),e._m(1),r("router-link",{staticClass:"nav-link",attrs:{to:"/map"}},[e._v("Carte")]),r("p",[e._v(" La carte permet de localiser par des icones les parcelles observées par l'utilisateur mais aussi les parcelles pour lesquelles l'utilisateur est destinataire du partage d'observations. Recentrer la carte sur une campagne, une semaine et une parcelle d'intéret à l'aide des menus de controles situé en haut de pages. Cliquer sur une icone de parcelle pour accéder aux informations résumés sur la croissance des Apex de la parcelle. Chaque icone localisée sur la carte prend une couleur du vert pale au vert foncé dépendant de l'indice de croissance. Comparer la croissance des Apex de la campagne précédente en passant le curseur sur le bouton campagne précédente. Les indicateurs de croissance pour la semaine et la campagne, sont instantannément recalculé en fonction chaque de la campagne, de la semaine et de la parcelle sélectionnée. Ces indicateurs d'évolution de croissance sont issus d'Apex Vignes. ")]),r("router-link",{staticClass:"nav-link",attrs:{to:"/edit"}},[e._v("Editer")]),r("p",[e._v(" Cette fonctionnalité permet d'ajouter ou de mettre à jour le résumé des observations collectées concernant l'état des Apex. Les informations mises à jour peuvent concerner à la fois les résumés d'observations collectées par l'utilisateur ou encore les résumés d'observations partagés par d'autres utilisateurs. Les modifications effectuées par un utilisateur sur les résumés d'observations collectées ou recues, sont implémentées par de vues modifiables sur les données. Ces vues ne sont visibles que par l'utilisateur et ne modifie ni les observations collectées par l'utilisateur ni les observations partagées par un autre utilisateur. En cliquant sur Réinitialiser, tout utilisateur a la posibilité d'effacer les modifications qu'il a effectué pour une parcelle donnée afin de se baser à nouveau sur les observations collectées. ")]),r("router-link",{staticClass:"nav-link",attrs:{to:"/partage"}},[e._v("Patager")]),r("p",[e._v(" La fonctionnalité de partage permet de partager les observations collectées par un utilisateur sur une parcelle avec un autre utilisateur. Les observations partagées ne concernent que le résumé de données collectées sur le terrain par l'utilisateur. Afin de controler le partage d'observations un utilisateur ne peut pas partager les résumés d'observations qu'il a lui meme recu en partage. Sur la page de Partage un utilisateur peut ")]),r("router-link",{staticClass:"nav-link",attrs:{to:"/partage"}},[e._v("Exporter")]),r("p",[e._v(" Cette fonctionalité permet d'exporter au format pdf ou csv les résumés des observations et les indicateurs de croissances des apex sur une campagne sélectionnée. ")]),r("h5",[e._v("Contributeurs")]),r("p",[e._v(" L'application Apex Territoire est à l'initiative de Léo Pichon (porteur du projet) et reprend les éléments de la charte graphique et les indicateurs de croissance développés par Guilhem Brunel et Léo Pichon dans l’application ApeX Vigne. L'application Apex Territoire a été développé par la cellule d'appui en informatique de #Digitag (Vincent Armant responsable du développement et Amine Ouail développeur). ")])],1):e._e()])},We=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v(" Le projet Apex Territoire est porté par Léo Pichon et a bénéficié du développement de la cellule d'appui en informatique des projets soutenus par #Digitag. Poute information contactez leo.pichon@gmail.com. Dans la suite nous détaillons les objectifs et le guide d'utilisation d'Apex Territoire. Vous pouvez directement commencez et cliquer sur l'onglet "),r("a",{attrs:{href:"#/map"}},[e._v("Carte")]),e._v(" puis revenir sur le guide d'utilisation pour avoir plus d'informations sur les fonctionalités implémentées. ")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v(" Apex territoire fait suite et est complémentaire à l'application Apex Vignes. L'objectif premier d'Apex Territoire est de proposer aux utilisateurs une "),r("b",[e._v(" visualisation et une analyse spatio-temporelle de la croissance des apex observées.")]),e._v(" Autour de cet objectif, nous avons implémentés de nouvelles fonctionnalités permettant aux utilisateurs d'ajouter, de mettre à jour et de partager leurs observations. Ainsi, en plus de proposer une visualisation géolocalisées des indicateurs de croissance des apex, Apex Territoire est aussi une plate forme qui permet la mise-à-jour et le partage d'indicateurs qui permettront de mieux comprendre et comparer la croissance des apex de vignes à travers différentes campagne et différents parcelles. Pour satifaire ces objectifs plusieurs fonctionalités ont été implémentés: ")])}],Pe={name:"Guide",created:function(){this.$store.state.loggedUserEmail||this.$router.push("/")},mounted:function(){this.$store.state.loggedUserEmail||this.$router.push("/")},methods:{}},Ne=Pe,Ee=(r("e090"),Object(_["a"])(Ne,De,We,!1,null,"7728dcea",null)),Ue=Ee.exports,Le=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login",staticStyle:{"background-image":"url(images/imagee.png)","background-size":"2000px 1000px",padding:"30px",margin:"1px"}},[r("div",{staticClass:"col-md-12"},[r("div",{staticClass:"card card-container"},[r("img",{staticClass:"profile-img-card",attrs:{id:"profile-img",src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png"}}),r("h1",[e._v("Login")]),r("div",{staticClass:"form-group"},[e._m(0),r("input",{directives:[{name:"model",rawName:"v-model",value:e.EMail,expression:"EMail"}],staticClass:"form-control",attrs:{type:"text",name:"EMail"},domProps:{value:e.EMail},on:{input:function(t){t.target.composing||(e.EMail=t.target.value)}}}),r("p",{staticStyle:{display:"block"},attrs:{id:"p"}},[e._v(" Visiteur en mode démo : clicker directement sur ")]),r("button",{staticClass:"btn btn-primary btn-block",staticStyle:{display:"block"},attrs:{id:"div1"},on:{click:function(t){return e.checkEMail()}}},[r("span",[e._v("Continuer")])]),r("p",[e._v(e._s(e.msg))])]),e.$store.state.mailpresent?r("div",{staticClass:"form-group"},[e._m(1),r("p",[e._v("Voulez vous enregistrer un mot de passe")]),r("button",{staticClass:"btn btn-primary btn-block",on:{click:e.Oui}},[r("span",[e._v("Oui")])]),r("button",{staticClass:"btn btn-primary btn-block",on:{click:e.Non}},[r("span",[e._v("Non")])])]):e._e(),e.$store.state.PasswordRequire?r("div",{staticClass:"form-group"},[e._m(2),r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",name:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),r("button",{staticClass:"btn btn-primary btn-block",on:{click:function(t){return e.login()}}},[r("span",[e._v("Login")])]),r("p",[e._v(e._s(e.message))])]):e._e(),""!==e.$store.state.loggedUserEmail&&""===e.$store.state.activedNavbar?r("div",[r("p",[e._v("chargement ...")])]):e._e()])])])},Ae=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{attrs:{for:"EMail"}},[r("b",[e._v("Mail")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{attrs:{for:"password"}},[r("b",[e._v("Mot de passe")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{attrs:{for:"password"}},[r("b",[e._v("Mot de passe")])])}],Ye={data:function(){return{EMail:"",msg:"",message:"",password:"",activedNavbar:"",mailpresent:"",PasswordRequire:""}},methods:{checkEMail:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:""===e.EMail?(r="Toto@tu.ti",e.$store.commit("initLoggedUserEmail",r),e.$store.commit("initDemoUserEmail",r),m.getObservations(r).then((function(t){var r=m.extractUserDataObjFrom(t);console.log(r),m.addSharedParcelObservations(r).then((function(){m.addWeeksToUserDataObj(r),m.enforceConsistencyOfUserDataObj(r),m.sortUserDataObjByYearByWeek(r),e.$store.commit("initUserDataObj",r),console.log("updated $store.state.userDataObj: "),console.log(e.$store.state.userDataObj),e.$store.dispatch("initUserModifiedWeekMetrics").then((function(){var t="true";e.$store.commit("initActivedNavbar",t),console.log("Routing to ApexMap"),e.$router.push("/guide")}))}))}))):(a=e.EMail,m.checkEMail(a).then((function(t){!0===t?(e.$store.commit("initLoggedUserEmail",a),m.checkEMailAuth(a).then((function(t){!0===t?m.checkpasswordRequire(a).then((function(t){if(!0===t){document.getElementById("div1").style.display="none",document.getElementById("p").style.display="none";var r="true";e.$store.commit("initPasswordRequire",r)}else m.getObservations(a).then((function(t){var r=m.extractUserDataObjFrom(t);console.log(r),m.addSharedParcelObservations(r).then((function(){m.addWeeksToUserDataObj(r),m.enforceConsistencyOfUserDataObj(r),m.sortUserDataObjByYearByWeek(r),e.$store.commit("initUserDataObj",r),console.log("updated $store.state.userDataObj: "),console.log(e.$store.state.userDataObj),e.$store.dispatch("initUserModifiedWeekMetrics").then((function(){var t="true";e.$store.commit("initActivedNavbar",t),console.log("Routing to ApexMap"),e.$router.push("/map")}))}))}))})):m.getObservations(a).then((function(t){var r=m.extractUserDataObjFrom(t);console.log(r),m.addSharedParcelObservations(r).then((function(){m.addWeeksToUserDataObj(r),m.enforceConsistencyOfUserDataObj(r),m.sortUserDataObjByYearByWeek(r),e.$store.commit("initUserDataObj",r),console.log("updated $store.state.userDataObj: "),console.log(e.$store.state.userDataObj),e.$store.dispatch("initUserModifiedWeekMetrics").then((function(){var t="true";e.$store.commit("initActivedNavbar",t),document.getElementById("div1").style.display="none",document.getElementById("p").style.display="none";var r="true";e.$store.commit("initmailpresent",r),m.mailAddToAuth(a).then((function(e){!0===e&&console.log("mail ajouté à l'authentification")}))}))}))}))}))):e.msg="mail inconnu, vérifier que le mail est enregistré dans ApeX Vignes"})));case 1:case"end":return t.stop()}}),t)})))()},Non:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.EMail,m.getObservations(r).then((function(t){var r=!0;e.$store.commit("initActivedNavbar",r);var a=m.extractUserDataObjFrom(t);console.log(a),m.addSharedParcelObservations(a).then((function(){m.addWeeksToUserDataObj(a),m.enforceConsistencyOfUserDataObj(a),m.sortUserDataObjByYearByWeek(a),e.$store.commit("initUserDataObj",a),console.log("updated $store.state.userDataObj: "),console.log(e.$store.state.userDataObj),e.$store.dispatch("initUserModifiedWeekMetrics").then((function(){var t="true";e.$store.commit("initActivedNavbar",t),console.log("Routing to ApexMap"),e.$router.push("/map")}))}))}));case 2:case"end":return t.stop()}}),t)})))()},Oui:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.EMail,e.$store.commit("initLoggedUserEmail",r),console.log("Routing to addpsw"),e.$router.push("/addpsw");case 4:case"end":return t.stop()}}),t)})))()},login:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:try{r=e.password,a=e.EMail,m.checkPassword(r,a).then((function(t){if(!0===t){var r="true";e.$store.commit("initActivedNavbar",r),m.getObservations(a).then((function(t){var r=m.extractUserDataObjFrom(t);console.log(r),m.addSharedParcelObservations(r).then((function(){m.addWeeksToUserDataObj(r),m.enforceConsistencyOfUserDataObj(r),m.sortUserDataObjByYearByWeek(r),e.$store.commit("initUserDataObj",r),console.log("updated $store.state.userDataObj: "),console.log(e.$store.state.userDataObj),e.$store.dispatch("initUserModifiedWeekMetrics").then((function(){var t="true";e.$store.commit("initActivedNavbar",t),console.log("Routing to ApexMap"),e.$router.push("/map")}))}))}))}else console.log("mot de passe non valide"),e.message="mot de passe non valide"}))}catch(s){e.error=s.message}case 1:case"end":return t.stop()}}),t)})))()}}},Re=Ye,Ge=(r("fe87"),Object(_["a"])(Re,Le,Ae,!1,null,"2c784162",null)),Te=Ge.exports,Be=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"global"},[r("div",{staticClass:"col-md-12"},[r("div",{staticClass:"card card-container"},[r("form",{attrs:{name:"form"}},[r("h4",[e._v("Ajouter un mot de passe")]),e._m(0),r("p",[e._v(e._s(e.$store.state.userDataObj.userEMail))]),e._m(1),r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",placeholder:"Password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._m(2),r("input",{directives:[{name:"model",rawName:"v-model",value:e.password_repeat,expression:"password_repeat"}],staticClass:"form-control",attrs:{type:"password",placeholder:"Password (repeat)"},domProps:{value:e.password_repeat},on:{input:function(t){t.target.composing||(e.password_repeat=t.target.value)}}}),r("button",{staticClass:"btn btn-primary btn-sm",staticStyle:{"margin-top":"10px"},attrs:{id:"buttoninsert"},on:{click:function(t){return e.updatepws()}}},[e._v(" Modifier ")]),r("p",[e._v(e._s(e.msg))])])])])])},Fe=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{attrs:{for:"mail"}},[r("b",[e._v("Mail")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{attrs:{for:"password"}},[r("b",[e._v("Passeword")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{attrs:{for:"password-r"}},[r("b",[e._v("Passeword repeat")])])}],qe={data:function(){return{mail:"",password:null,password_repeat:null,msg:"",UserEMail:""}},created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.state.loggedUserEmail||e.$router.push("/");case 1:case"end":return t.stop()}}),t)})))()},methods:{updatepws:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.password,a=e.password_repeat,s=e.$store.state.loggedUserEmail,null===r&&null===a||(r===a?(e.msg="",m.pwsadd({transaction:"alter_password",UserEMail:s,password:r,passwordRequire:1}).then((function(){console.log("Routing to ApexMap"),e.$router.push("/map")}))):e.msg="les mots de passe saisis ne sont pas identiques",""!==r&&""!==a||(e.msg="il faut remplir toutes les cases"));case 4:case"end":return t.stop()}}),t)})))()}}},ze=qe,He=(r("f52c"),Object(_["a"])(ze,Be,Fe,!1,null,"01ec0438",null)),Ve=He.exports,Je=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container",staticStyle:{"margin-bottom":"50px"}},[r("div",{staticClass:"row justify-content-center"},[r("div",{staticClass:"col-6"},[r("div",{staticClass:"card card-default"},[r("div",{staticClass:"card-header"},[e._v("Reset Password")]),r("div",{staticClass:"card-body"},[r("form",{attrs:{autocomplete:"off",method:"post"},on:{submit:function(t){return t.preventDefault(),e.requestResetPassword(t)}}},[r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"email"}},[e._v("E-mail")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"form-control",attrs:{type:"email",id:"email",placeholder:"user@example.com",required:""},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})]),r("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v("Send Password Reset Link")])])]),r("p",[e._v(e._s(e.message))])])])])])},Xe=[],Ze={data:function(){return{email:null,has_error:!1,message:""}},methods:{requestResetPassword:function(){var e=this,t=this.email;m.checkEMail(t).then((function(t){e.message=!0===t?"mail trouvé":"mail non enregistré"}))}}},Qe=Ze,Ke=Object(_["a"])(Qe,Je,Xe,!1,null,null,null),et=Ke.exports;a["default"].use(T["a"]);var tt=new T["a"]({routes:[{path:"/map",name:"map",component:ne},{path:"/edit",name:"edit",component:ue},{path:"/partage",name:"partage",component:fe},{path:"/export",name:"export",component:Oe},{path:"/profil",name:"profil",component:Se},{path:"/guide",name:"guide",component:Ue},{path:"/",name:"login",component:Te},{path:"/addpsw",name:"addpsw",component:Ve},{path:"/resetp",name:"resetp",component:et}]}),rt=r("5f5b"),at=r("b1e0");a["default"].use(rt["a"]),a["default"].use(at["a"]),a["default"].config.productionTip=!1,new a["default"]({store:v,router:tt,render:function(e){return e(G)}}).$mount("#app")},"61ce":function(e,t,r){},"6cb1":function(e,t,r){},"6e1e":function(e,t,r){"use strict";var a=r("3588"),s=r.n(a);s.a},8171:function(e,t,r){"use strict";var a=r("dbd9"),s=r.n(a);s.a},"84dd":function(e,t,r){},"85ec":function(e,t,r){},8600:function(e,t,r){},"8b49":function(e,t,r){"use strict";var a=r("61ce"),s=r.n(a);s.a},9117:function(e,t,r){},a3c9:function(e,t,r){"use strict";var a=r("e851"),s=r.n(a);s.a},c4c2:function(e,t,r){"use strict";var a=r("84dd"),s=r.n(a);s.a},db8a:function(e,t,r){},dbd9:function(e,t,r){},e090:function(e,t,r){"use strict";var a=r("39b3"),s=r.n(a);s.a},e851:function(e,t,r){},f52c:function(e,t,r){"use strict";var a=r("05a9"),s=r.n(a);s.a},fe87:function(e,t,r){"use strict";var a=r("9117"),s=r.n(a);s.a}});
//# sourceMappingURL=app.6fdc723f.js.map